{
  "in_pcloud": [
    "/hei/Hessigheim_Benchmark/Epoch_March2018/LiDAR/Mar18_train.laz"
  ],
  "out_pcloud": [
    "out/hae/*"
  ],
  "sequential_pipeline": [
	{
	  "miner": "HSVFromRGB",
 	  "hue_unit": "radians",
	  "frenames": ["HSV_Hrad", "HSV_S", "HSV_V"]
	},
	{
		"imputer": "UnivariateImputer",
		"fnames": ["HSV_Hrad", "HSV_S", "HSV_V", "Reflectance"],
		"target_val": "NaN",
		"strategy": "mean"
	},
	{
		"feature_transformer": "Standardizer",
		"fnames": ["HSV_Hrad", "HSV_S", "HSV_V", "Reflectance"],
		"center": true,
		"scale": true,
		"report_path": "*standardization.log"
	},
	{
      "writer": "Writer",
      "out_pcloud": "*standardized.laz"
	},
    {
        "train": "ConvolutionalAutoencoderPwiseClassifier",
        "training_type": "base",
        "random_seed": null,
        "model_args": {
            "num_classes": 11,
            "class_names": ["LowVeg", "ImpSurf", "Vehicle", "UrbanFurni", "Roof", "Facade", "Shrub", "Tree", "Soil/Gravel", "VertSurf", "Chimney"],
			"fnames": ["HSV_Hrad", "HSV_S", "HSV_V", "Reflectance"],
            "pre_processing": {
                "pre_processor": "hierarchical_fps",
				"support_strategy_num_points": 5000,
                "to_unit_sphere": false,
            	"support_strategy": "fps",
            	"support_chunk_size": 2000,
            	"support_strategy_fast": false,
                "center_on_pcloud": true,
				"neighborhood": {
                    "type": "rectangular3D",
                    "radius": 3.0,
                    "separation_factor": 0.8
                },
                "num_points_per_depth": [2048, 1024, 512, 256, 64],				
				"fast_flag_per_depth": [false, false, false, false, false],
				"num_downsampling_neighbors": [1, 16, 16, 8, 4],
				"_num_downsampling_neighbors": [1, 1, 1, 1, 1],
				"num_pwise_neighbors": [64, 64, 32, 16, 8],
				"num_upsampling_neighbors": [1, 16, 16, 8, 4],
				"_num_upsampling_neighbors": [1, 1, 1, 1, 1],
                "nthreads": 12,
                "training_receptive_fields_distribution_report_path": "*/training_eval/training_receptive_fields_distribution.log",
                "training_receptive_fields_distribution_plot_path": "*/training_eval/training_receptive_fields_distribution.svg",
                "training_receptive_fields_dir": "*/training_eval/training_receptive_fields/",
                "receptive_fields_distribution_report_path": "*/training_eval/receptive_fields_distribution.log",
                "receptive_fields_distribution_plot_path": "*/training_eval/receptive_fields_distribution.svg",
                "receptive_fields_dir": "*/training_eval/receptive_fields/",
                "training_support_points_report_path": "*/training_eval/training_support_points.laz",
                "support_points_report_path": "*/training_eval/support_points.laz"
            },
			"feature_extraction": {
				"type": "PointNet",
				"operations_per_depth": [2, 1, 1, 1, 1],
				"feature_space_dims": [64, 64, 128, 256, 512, 1024],
				"bn": true,
				"bn_momentum": 0.0,
				"H_activation": ["relu", "relu", "relu", "relu", "relu", "relu"],
				"H_initializer": ["glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform"],
				"H_regularizer": [null, null, null, null, null, null],
				"H_constraint": [null, null, null, null, null, null],
				"gamma_activation": ["relu", "relu", "relu", "relu", "relu", "relu"],
				"gamma_kernel_initializer": ["glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform", "glorot_uniform"],
				"gamma_kernel_regularizer": [null, null, null, null, null, null],
				"gamma_kernel_constraint": [null, null, null, null, null, null],
				"gamma_bias_enabled": [true, true, true, true, true, true],
				"gamma_bias_initializer": ["zeros", "zeros", "zeros", "zeros", "zeros", "zeros"],
				"gamma_bias_regularizer": [null, null, null, null, null, null],
				"gamma_bias_constraint": [null, null, null, null, null, null]
			},
			"downsampling_filter": "gaussian",
			"upsampling_filter": "gaussian",
			"upsampling_bn": true,
			"upsampling_momentum": 0.0,
			"conv1d_kernel_initializer": "glorot_normal",
			"output_kernel_initializer": "glorot_normal",
            "model_handling": {
                "summary_report_path": "*/model_summary.log",
                "training_history_dir": "*/training_eval/history",
                "features_structuring_representation_dir": "*/training_eval/feat_struct_layer/",
                "class_weight": [0.2, 0.3, 0.4, 0.4, 0.3, 0.4, 0.4, 0.3, 0.3, 0.4, 1.5],
                "training_epochs": 400,
                "batch_size": 8,
                "checkpoint_path": "*/checkpoint.model",
                "checkpoint_monitor": "loss",
                "learning_rate_on_plateau": {
                    "monitor": "loss",
                    "mode": "min",
                    "factor": 0.1,
                    "patience": 2000,
                    "cooldown": 5,
                    "min_delta": 0.01,
                    "min_lr": 1e-6
                }
            },
            "compilation_args": {
                "optimizer": {
                    "algorithm": "SGD",
                    "learning_rate": {
                        "schedule": "exponential_decay",
                        "schedule_args": {
                            "initial_learning_rate": 1e-2,
                            "decay_steps": 1500,
                            "decay_rate": 0.96,
                            "staircase": false
                        }
                    }
                },
                "loss": {
                    "function": "class_weighted_categorical_crossentropy"
                },
                "metrics": [
                    "categorical_accuracy"
                ]
            },
            "architecture_graph_path": "*/model_graph.png",
            "architecture_graph_args": {
                "show_shapes": true,
                "show_dtype": true,
                "show_layer_names": true,
                "rankdir": "TB",
                "expand_nested": true,
                "dpi": 300,
                "show_layer_activations": true
            }
        },
        "autoval_metrics": ["OA", "P", "R", "F1", "IoU", "wP", "wR", "wF1", "wIoU", "MCC", "Kappa"],
        "training_evaluation_metrics": ["OA", "P", "R", "F1", "IoU", "wP", "wR", "wF1", "wIoU", "MCC", "Kappa"],
        "training_class_evaluation_metrics": ["P", "R", "F1", "IoU"],
        "training_evaluation_report_path": "*/training_eval/evaluation.log",
        "training_class_evaluation_report_path": "*/training_eval/class_evaluation.log",
        "training_confusion_matrix_report_path": "*/training_eval/confusion.log",
        "training_confusion_matrix_plot_path": "*/training_eval/confusion.svg",
        "training_class_distribution_report_path": "*/training_eval/class_distribution.log",
        "training_class_distribution_plot_path": "*/training_eval/class_distribution.svg",
        "training_classified_point_cloud_path": "*/training_eval/classified_point_cloud.laz",
        "training_activations_path": "*/training_eval/activations.laz"
    },
    {
      "writer": "PredictivePipelineWriter",
      "out_pipeline": "*pipe/HAE_T1.pipe",
      "include_writer": false,
      "include_imputer": true,
      "include_feature_transformer": true,
      "include_miner": true,
      "include_class_transformer": true
    }
  ]
}